{% extends "homepage/layout.html" %}

{% load homepage_extras %}

{% block title %}Forcefields{% endblock %}

{% block content %}

  <h1>Forcefields</h1>
  <br>

  <form action="" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {% for field in form %}
      <div class="row py-1 ml-5">
        <div class="col-4 col-xl-2 col-lg-3 col-md-4 pt-1">
          {% if field.name == "ff_file" %}
            <label for="{{ field.id_for_label }}">Forcefield files:
              <span data-toggle="popover" data-trigger="hover" title="Forcefield files" data-html="true"
                    data-content="Use a zip file containing the forcefield directory. This directory can be used as it
                                  is to run membrane simulations and for Gromacs, it will be used during the validation
                                  process of new topologies.">
                  <i class="fas fa-info-circle text-success"></i>
              </span>
            </label>
          {% elif field.name == "mdp_file" %}
            <label for="{{ field.id_for_label }}">Parameters files:
              <span data-toggle="popover" data-trigger="hover" title="Parameters files" data-html="true"
                    data-content="Use a zip file containing the parameters files for minimization, nvt, npt and
                                  production  run. For Gromacs, files must be in the format used since the version 5 and
                                  the files named em.mdp, nvt.mdp, npt.mdp and run.mdp.">
                  <i class="fas fa-info-circle text-success"></i>
              </span>
            </label>
          {% else %}
            {{ field.label_tag }}
          {% endif %}
        </div>
        <div class="col-8 col-lg-4">
          {% if field.name == "ff_file" or field.name == "mdp_file"%}
            <div class="input-group">
              <div class="custom-file">
                <input type="file" id="{{ field.id_for_label }}" name="{{ field.html_name }}"
                       class="custom-file-input"  accept=".zip"
                       {% if field.name == "ff_file" %}
                         onchange="$('#ff_filetext').text($(this).val().split('\\').slice(-1)[0]);"
                       {% else %}
                         onchange="$('#mdp_filetext').text($(this).val().split('\\').slice(-1)[0]);"
                       {% endif %}>
                <label id="{{ field.name }}text" class="custom-file-label" for="{{ field.id_for_label }}">
                    {{ field.value|basename }}</label>
              </div>
            </div>
          {% else %}
            {{ field }}
          {% endif %}
          {% if field.help_text %}<small class="text-secondary">{{ field.help_text }}</small>{% endif %}
          {% for error in field.errors %}<p class="text-danger">{{ error }}</p>{% endfor %}
        </div>
      </div>
    {% endfor %}
    <div class="row ml-5">
      <div class="col-auto pt-1">
        <button type="submit" class="btn btn-primary">{% if ffcreate %}Add{% else %}Update{% endif %}</button>
      </div>
    </div>
  </form>

{% endblock %}


{% block script %}

  <script>
    $(document).ready(function(){
      $('[data-toggle="popover"]').popover();
    });
  </script>
  {{ form.media }}

{% endblock %}
